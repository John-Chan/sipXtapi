#!/bin/bash

# Copyright (c) 2002 Pingtel Corp.

CONFIG_DEFS="@SIPXPBXCONF@/config.defs"

CONFIG_FILES="\
  @SIPXPBXCONF@/authproxy-config \
  @SIPXPBXCONF@/authrules.xml \
  "

# Common environment variables used by the in memory database (IMDB)
export SIPX_DB_VAR_PATH=@localstatedir@
export SIPX_DB_ETC_PATH=@SIPXPBXCONF@

# If the "config.defs" file exists and the <name>.in file exists for a
# configuration file, then run the config preprocessor to generate the
# fully resolved configuration file.
if [ -f "$CONFIG_DEFS" ]
then
  for i in $CONFIG_FILES ; do
    if [ -f "${i}.in" ]
    then
       @bindir@/configpp --defs "${CONFIG_DEFS}" --in "${i}.in" --out "$i"
    fi
  done
fi

exec @bindir@/sipauthproxy $@
