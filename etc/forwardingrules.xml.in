<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<routes>
  <route mappingType="local">
    <!-- Route to the config service -->
    <routeFrom>sipuaconfig.${SIPXCHANGE_DOMAIN_NAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>sipuaconfig:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeTo>${CONFIG_SERVER_SERVER_SIP_SRV_OR_HOSTPORT}</routeTo>
  </route>
  <route mappingType="local">
    <routeFrom>${SIPXCHANGE_DOMAIN_NAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${MY_IP_ADDR}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${MY_FULL_HOSTNAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${MY_HOSTNAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <methodMatch>
      <methodPattern>SUBSCRIBE</methodPattern>
      <fieldMatch fieldName="Event">
        <!-- Config service events -->
        <fieldPattern>sip-config.*</fieldPattern>
        <!-- SUBSCRIBEs with the event field containg above pattern-->
        <!-- will go to the Config server SDS-->
        <routeTo>${CONFIG_SERVER_SERVER_SIP_SRV_OR_HOSTPORT}</routeTo>
      </fieldMatch>
      <fieldMatch fieldName="Event">
        <!-- Message waiting indication events -->
        <fieldPattern>message-summary.*</fieldPattern>
        <!--this goes to the status server-->
        <routeTo>${STATUS_SERVER_SIP_SRV_OR_HOSTPORT}</routeTo>
      </fieldMatch>
      <!-- All other SUBSCRIBE requests go to the SIP registry service -->
      <routeTo>${REGISTRAR_SERVER_SIP_SRV_OR_HOSTPORT}</routeTo>
    </methodMatch>
    <!-- All other requests go to the SIP registry service -->
    <routeTo>${REGISTRAR_SERVER_SIP_SRV_OR_HOSTPORT}</routeTo>
  </route>
</routes>

