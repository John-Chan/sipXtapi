<?xml version="1.0" encoding="UTF-8" ?>
<!--  -->

<project name="neoconf" default="default" basedir=".">

	<property name="test.src.dir" value="test" />
	<property name="checkstyle.severity" value="error" />

	<property name="project.dir" value="neoconf" />
	<import file="../ant-targets.xml" />

	<!-- 
	    - common path unittests will need that interfaces w/neoconf lib 
	    - all spring jars at this point
	    -->
	<path id="compile.dependencies">
		<pathelement path="${spring.jar}" />
		<pathelement path="${hibernate2.jar}" />
		<pathelement path="${servlet.jar}" />
	</path>

	<!-- 
	    - common path unittests will need that interfaces w/neoconf lib 
	    - all spring jars at this point
	    -->
	<path id="runtime.dependencies">
		<pathelement path="${commons-logging.jar}" />
		<pathelement path="${commons-dbcp.jar}" />
		<pathelement path="${commons-pool.jar}" />
		<pathelement path="${aopalliance.jar}" />
		<pathelement path="${dom4j.jar}" />
		<pathelement path="${commons-collections.jar}" />
		<pathelement path="${ehcache.jar}" />
		<pathelement path="${cglib-full.jar}" />
		<pathelement path="${jta.jar}" />
		<pathelement path="${jdbc-driver.jar}" />
		<pathelement path="${odmg.jar}" />
	</path>

	<path id="base.path">

		<path refid="compile.dependencies" />

		<!-- TEST -->
		<!-- TODO: Separate these from compile dependencies -->
		<path refid="runtime.dependencies" />

		<!-- TEST -->
		<pathelement path="${easymock.jar}" />
	</path>
	<property name="classpath" refid="base.path" />

	<target name="init" depends="ant-targets.init">
		<mkdir dir="${dist.dir}/war-root" />
	</target>

        <!-- D E F A U L T -->
        <target name="default" depends="war"/>

	<!-- C O M P I L E -->
	<target name="compile" depends="init">
		<javac srcdir="${src.dir}/" destdir="${classes.dir}" classpathref="base.path" debug="${debug}" debuglevel="${debuglevel}" deprecation="on" optimize="${optimize}" includes="**/*.java" />

	</target>

	<!-- J A R -->
	<target name="war" depends="compile" description="assemble neoconf war">
		
		<!-- dependset>
			<srcfileset dir="site" includes="**/*"/>
			<targetfileset file="${neoconf.war}" />
		</dependset -->

		<war warfile="${neoconf.war}" webxml="etc/WEB-INF/web.xml" basedir="${dist.dir}/war-root">

			<fileset dir="site" />

			<webinf dir="etc/WEB-INF">
				<!-- avoid warning about already there -->
				<exclude name="web.xml" />
			</webinf>

			<classes dir="${classes.dir}" />
			<classes dir="${src.dir}">
				<include name="**/*.xml" />
			</classes>

			<lib file="${spring.jar}" />
			<lib file="${hibernate2.jar}" />
			<lib file="${odmg.jar}" />
			<lib file="${commons-logging.jar}" />
			<lib file="${commons-dbcp.jar}" />
			<lib file="${commons-pool.jar}" />
<!-- JSF -->
			<lib file="${commons-digester.jar}" />
			<lib file="${commons-beanutils.jar}" />
			<lib file="${jsf-api.jar}" />
			<lib file="${jsf-impl.jar}" />
			<lib file="${jstl.jar}" />
			<!-- TEMP DISABLED UNTIL DETERMINED NEEDED
			  lib file="${jsf-spring.jar}" / -->

			
			<lib file="${aopalliance.jar}" />
			<lib file="${dom4j.jar}" />
			<lib file="${commons-collections.jar}" />
			<lib file="${ehcache.jar}" />
			<lib file="${cglib-full.jar}" />
			<lib file="${jta.jar}" />

		</war>
	</target>

	<target name="install" depends="war"
	   description="Copy war file into Jboss deploy directory">

		<copy todir="${dest.dir}${jboss.container.deploy}" file="${neoconf.war}"/>

	</target>

	<target name="install-tomcat" depends="war"
	   description="Copy war file into Tomcat 5 webapp directory">

		<copy todir="/opt/tomcat5/webapps" file="${neoconf.war}"/>

	</target>

</project>


