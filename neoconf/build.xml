<?xml version="1.0" encoding="UTF-8" ?>
<!--  -->

<project name="neoconf" default="default" basedir=".">

	<property name="test.src.dir" value="test" />
	<property name="checkstyle.severity" value="error" />

	<property name="project.dir" value="neoconf" />
	<import file="../ant-targets.xml" />

	<!-- 
	    - common path unittests will need that interfaces w/sipxconfig lib 
	    - all spring jars at this point
	    -->
	<path id="compile.dependencies">
		<pathelement path="${spring.jar}" />
		<pathelement path="${hibernate2.jar}" />
		<pathelement path="${servlet.jar}" />
	</path>

	<!-- 
	    - common path unittests will need that interfaces w/sipxconfig lib 
	    - all spring jars at this point
	    -->
	<path id="runtime.dependencies">
		<pathelement path="${commons-logging.jar}" />
		<pathelement path="${commons-dbcp.jar}" />
		<pathelement path="${commons-pool.jar}" />
		<pathelement path="${aopalliance.jar}" />
		<pathelement path="${dom4j.jar}" />
		<pathelement path="${commons-collections.jar}" />
		<pathelement path="${ehcache.jar}" />
		<pathelement path="${cglib-full.jar}" />
		<pathelement path="${jta.jar}" />
		<pathelement path="${jdbc-driver.jar}" />
		<pathelement path="${odmg.jar}" />
	</path>

	<path id="base.path">

		<path refid="compile.dependencies" />

		<!-- TEST -->
		<!-- TODO: Separate these from compile dependencies -->
		<path refid="runtime.dependencies" />

		<!-- TEST -->
		<pathelement path="${easymock.jar}" />
	</path>
	<property name="classpath" refid="base.path" />

	<!-- D E F A U L T -->
	<target name="default" depends="jar"/>
	
	<!-- J A R -->
	<target name="jar" depends="compile" description="assemble sipxconfig jar library">
		<jar file="${sipxconfig.jar}">
			<fileset dir="${classes.dir}"/>
			<fileset dir="${src.dir}">
				<include name="**/*.xml"/>
				<include name="**/*.properties"/>
			</fileset>
	    </jar>
	</target>

	<!-- D E V E L O P E R   T A S K S -->
	<target name="reset-db-patch" 
		description="apply patches to database for new components, clears all data for the new components">
		<!-- may fail if never run so ignore failed output -->
		<exec executable="psql" failonerror="false">
			<arg line=" -U postgres PDS -f ${top.dir}/profilegenerator/ejb/meta/patches/delete_v8_mods.sql"/>
		</exec>
		<exec executable="psql" failonerror="true">
			<arg line=" -U postgres PDS -f ${top.dir}/profilegenerator/ejb/meta/patches/v8_mods.sql"/>
		</exec>
    </target>

</project>


