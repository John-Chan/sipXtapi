<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<routes xmlns='http://www.sipfoundry.org/sipX/schema/xml/forwardingrules-00-00'>

  <route mappingType="mydomain">
    <documentation>
      Matches the SIPXCHANGE_DOMAIN_NAME (and all aliases for it).
      Routes SUBSCRIBE for message waiting indication to the status server.
      All other requests go to the SIP registry/redirect service.
    </documentation>

    <routeFrom>${SIPXCHANGE_DOMAIN_NAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${MY_IP_ADDR}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${MY_FULL_HOSTNAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${MY_HOSTNAME}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${INTEROP_ALIAS_UDP}:${PROXY_SERVER_SIP_PORT}</routeFrom>
    <routeFrom>${INTEROP_ALIAS_TCP}:${PROXY_SERVER_SIP_PORT}</routeFrom>

    <methodMatch>
      <methodPattern>SUBSCRIBE</methodPattern>

      <documentation>
        Message waiting indication subscriptions go to the status server.
        All other SUBSCRIBE requests go to the SIP registry service.
      </documentation>
      <fieldMatch fieldName="Event">
        <fieldPattern>message-summary.*</fieldPattern>
        <routeTo>&lt;${STATUS_SERVER_SIP_SRV_OR_HOSTPORT};transport=tcp&gt;</routeTo>
      </fieldMatch>

      <routeTo>&lt;${REGISTRAR_SERVER_SIP_SRV_OR_HOSTPORT}&gt;</routeTo>

    </methodMatch>

    <routeTo>&lt;${REGISTRAR_SERVER_SIP_SRV_OR_HOSTPORT}&gt;</routeTo>

  </route>

<!-- show some examples 
  <route mappingType="enterprise">
    <documentation>
      All other requests to an internal IPv4 address or to a SIP domain
      within Pingtel are routed through the
      authorization proxy for permission checking.
    </documentation>
    <routeFrom type="IPv4">10.*</routeFrom>
    <routeFrom type="DNSpattern">*.pingtel.com</routeFrom>

    <routeTo>${AUTH_PROXY_SERVER_SIP_SRV_OR_HOSTPORT}</routeTo>
  </route>

  <route mappingType="external">
    <documentation>
      All other requests targetted directly to a domain name or non-local
      IP address are routed through the authorization proxy for permission
      checking, and then to the session border controller to be passed 
      outside.
    </documentation>
    <routeFrom type="DNSpattern">*</routeFrom>
    <routeTo>${AUTH_PROXY_SERVER_SIP_SRV_OR_HOSTPORT},sbc.pingtel.com</routeTo>
  </route>
-->

</routes>

