


<html>
    <head>
        <script src="../script/validate.js"></script>
        <script language="JavaScript">
            var validator = new Validate();
            function getValues()
            {
                var form = document.frmEditAuthCaller;
                var query = location.search.substring(1);
                var values = new Array();
                var pairs = query.split( "&" );
                for ( i = 0; i < pairs.length; i++ )
                {
                    var pos = pairs[i].indexOf( "=" );
                    values[i] = pairs[i].substring(pos + 1);
                }
                var id = values[0];
                var rpid = values[1];
                form.oldid.value = id;
                form.rpid.value = rpid;


                var div = this.opener.mainFrame.mainFrame.document.getElementById(id);
                var children = div.childNodes;
                for ( i = 0; i < children.length; i++ )
                {
                    if ( children[i].id == "authcaller_user" )
                    {
                        form.user.value = children[i].value;
                    }
                 }
            }
            function formSubmit( form )
            {
                if ( form.user.value == "" )
                {
                    alert( "Please fill in the User Name field" );
                }
                else if ( form.password.value != form.password2.value )
                {
                    alert( "Your password fields do not match.\n" +
                        "Please try again." );
                    form.password.value = "";
                    form.password2.value = "";
                }
                else
                {
                    var user = validator.trim(form.user.value);
                    var password = form.password.value;
                    var id = form.oldid.value;
                    var rpid = form.rpid.value;
                    this.opener.top.mainFrame.add_authcaller(user, password, rpid, "true", id );
                    this.window.close();
                }
            }
            function closeWindow()
            {
                this.window.close();
            }
        </script>
        <title>Edit Authorized Caller</title>
        <link rel="stylesheet" href="../../style/dms.css" type="text/css">
    </head>
    <body class="bglight" onload="getValues()">
        <p>&nbsp;</p>
		<p class="formtitle" align="center">Edit Authorized Caller</p>
        <form name="frmEditAuthCaller">
            <table width="150" border="0" cellspacing="3" cellpadding="0" align="center">
                <tr>
                    <td class="formtext" nowrap>User Name</td>
                    <td>
                        <input type="text" name="user" size="20">
                    </td>
                </tr>
                <tr>
                    <td class="formtext" nowrap>Password</td>
                    <td>
                        <input type="password" name="password" size="20">
                    </td>
                </tr>
                <tr>
                    <td class="formtext" nowrap>Confirm Password</td>
                    <td>
                        <input type="password" name="password2" size="20">
                    </td>
                </tr>
            </table>
            <br>
            <div align="center">
                <input type="button" name="cmdSubmitForm" value="Submit" onclick="formSubmit(this.form)">&nbsp;&nbsp;
                <input type="button" name="cmdCloseWindow" value="Cancel" onclick="closeWindow()"/>
            </div>
            <input type="hidden" name="oldid"/>
            <input type="hidden" name="rpid"/>
        </form>
    </body>
    </html>
