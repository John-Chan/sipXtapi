<html>
    <head>
        <script src="../script/validate.js"></script>
        <script language="JavaScript">
            var validator = new Validate();

            function formSubmit( form )
            {
                if ( form.url.value == "" )
                {
                        alert("Please fill in the SIP URL field");
                }
                else if ( form.registration.value == "" )
                {
                        alert("Please select from the registration selection box");
                }
                else if ( form.allow_forwarding.value == ""  )
                {
                    alert( "Please select from the Allow Forwarding selection box" );
                }
                else if ( !validator.isUserLineSIPURL(validator.trim(form.url.value)) )
                {
                    var msg = "You have entered an invalid sip url.\n" +
                              "A sip url must contain sip:xxx@\n" +
                              "Please try again."
                    alert (msg);
                }
                else
                {
                    var url = validator.trim(form.url.value);
                    var registration = validator.trim(form.registration.value);
                    var allow_forwarding = validator.trim(form.allow_forwarding.value);
                    var query = location.search.substring(1);
                    var pos = query.indexOf( "=" );
                    var rpid = query.substring(pos + 1);
                    this.opener.top.mainFrame.add_userline( url, registration,
                        allow_forwarding, rpid );
                    this.window.close();
                }
            }
            function closeWindow()
            {
                this.window.close();
            }
        </script>
        <title>Add User Line</title>
        <link rel="stylesheet" href="../../style/dms.css" type="text/css">
    </head>
    <body class="bglight">
        <p>&nbsp;</p>
		<p class="formtitle" align="center">Add a New User Line</p>
        <form name="frmUserLine">
            <table width="250" border="0" cellspacing="3" cellpadding="0" align="center">
                <tr>
                    <td class="formtext">SIP URL</td>
                    <td>
                        <input type="text" name="url" size="40">
                    </td>
                </tr>
                <tr>
                    <td class="formtext">Register with host or provision line as is</td>
                    <td>
                        <select name="registration" size="3">
                            <option value="blank">&lt;BLANK&gt;</option>
                            <option value="PROVISION">PROVISION</option>
                            <option value="REGISTER">REGISTER</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="formtext" nowrap>Apply rules for call forwarding</td>
                    <td>
                        <select name="allow_forwarding" size="3">
                            <option value="blank">&lt;BLANK&gt;</option>
                            <option value="DISABLE">DISABLE</option>
                            <option value="ENABLE">ENABLE</option>
                        </select>
                    </td>
                </tr>
            </table>
            <br>
            <div align="center">
                <input type="button" name="cmdSubmitForm" value="Submit" onclick="formSubmit(this.form)">&nbsp;&nbsp;
                <input type="button" name="cmdCloseWindow" value="Cancel" onclick="closeWindow()"/>
            </div>
        </form>
    </body>
</html>
