## Velocity macros
## emit 'setting value' pair
#macro(emit_setting $s)
${s.ProfileName}=$!{s.Value}
#end
## emit setting line for every setting in the group
#macro(emit_group $g)
[${g.ProfileName}]
#foreach ($s in $g.Values)
#emit_setting($s)
#end
#end
## emit setting line for some settings in the group
#macro(emit_settings $g $setting_names)
#foreach ($sn in $setting_names)
#emit_setting($g.getSetting($sn))
#end
#end
## emit all listed groups device
#macro(emit_groups_by_name $group_names)
#foreach ($gn in $group_names)
#emit_group($gateway.Settings.getSetting("$gn"))
#end
#end
## emit comma separated list of values
#macro(emit_csv $group $setting_names)
#foreach ($sn in $setting_names)
#if($velocityCount > 1),#end
#set($s=$group.getSetting($sn))
##$group.getSetting($sn).Value#end
#if($s && $s.Value)$s.Value#else$ignore#end
#end

#end
;**************
;** Ini File **
;**************

;generated from template by sipXconfig
;------------------------------

#emit_groups_by_name(['SIP', 'Network'])

#set($trunks = $gateway.Settings.getSetting('Trunks'))
[Trunks]
#foreach ($tg_index in [1..4])
#set($tg = $trunks.getSetting("TRUNKGROUP_$tg_index"))
TRUNKGROUP_$tg_index=#emit_csv($tg ['ChannelRange', 'StartPhoneNumber', 'HuntGroupNumber'])
#end

#emit_groups_by_name(['Telephony', 'Voice', 'Call_Routing'])

[Digit_Manipulation]
#set($dm = $gateway.Settings.getSetting('Digit_Manipulation'))
#emit_settings($dm ['RouteModeIP2Tel', 'RouteModeTel2IP'])
#set($t2i = $dm.getSetting('NUMBERMAPTEL2IP'))
NUMBERMAPTEL2IP=#emit_csv($t2i ['prefixtomatch', 'stripdigitcount', 'prefix-suffix', 'leavefromright', 'numberplan', 'numbertype', 'ANIPrefix'])
#set($i2t = $dm.getSetting('NUMBERMAPIP2TEL'))
NUMBERMAPIP2TEL=#emit_csv($i2t ['prefixtomatch', 'stripdigitcount', 'prefix-suffix', 'leavefromright', 'ignore', 'ignore', 'ANIPrefix', 'ignore', 'sourceIP'])
#set($s_t2i = $dm.getSetting('SourceNUMBERMAPTEL2IP'))
SourceNUMBERMAPTEL2IP=#emit_csv($s_t2i ['prefixtomatch', 'stripdigitcount', 'prefix-suffix', 'leavefromright', 'numberplan', 'numbertype', 'DNISPrefix', 'PresRestricted'])
#set($s_i2t = $dm.getSetting('SourceNUMBERMAPIP2TEL'))
SourceNUMBERMAPIP2TEL=#emit_csv($s_i2t ['prefixtomatch', 'stripdigitcount', 'prefix-suffix', 'leavefromright', 'ignore', 'ignore', 'DNISPrefix', 'ignore', 'sourceIP'])

#emit_groups_by_name(['Management_Interface'])

; must exist in the file
EnableLANWatchDog=1
IdlePCMPattern=85
LogoWidth=339
