<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>sipXconfig Troubleshooting</title>
  <link rel="stylesheet" type="text/css" href="manual.css" />
</head>
<body id="troubleshooting">
<h1>Troubleshooting</h1>
<p>Single most important tip for troubleshooting config server
components is inspect log files by searching of running <code>tail
-f</code> command while servers are running. Unless specified, all log
files go into one of these two locations</p>
<ul>
  <li>Tarball based installation log file location: <code>/usr/local/sipx/var/log/sipxpbx/</code></li>
  <li>RPM based installations log file: <code>/var/log/sipxpbx/</code></li>
</ul>
<h2>Profile Generator</h2>
<dl>
  <dt>Analyze the log</dt>
  <dd><code>${JBOSS_HOME}/jboss/log/server.log</code> - Web page error,
EJB errors. Log file for 90% of configuration system operations</dd>
  <dt>Change log level</dt>
  <dd>edit file:
    <code>${JBOSS_HOME}/server/sipx/conf/log4j.xml<span
 style="font-family: Verdana,Arial,Helvetica,sans-serif;" /></code> and
change
the debug flag: <code>param name="Threshold" value="DEBUG"</code> or <code>"INFO"
    </code>and restart processes.</dd>
  <dt>Replication to Commservers</dt>
  <dd>User information is sent to services like the sipXproxy. To
ensure infomation has been recieved, run this command:
    <pre>      sipdbtest display credential<br />    </pre>
You should see your basic user edits in this list. </dd>
  <dt>sipXregistry will not authorize my phone</dt>
  <dd>Assuming you've configured the phone line correctly, it's
possible the information did not get sent to appropriate sipX servers.
Check log file for error in communication. Java VM needs to have
correct certificate authority imported, see <code>install-cert.sh</code>
file. Lastly, check the timestamp of the <code>credentials.xml</code>
file to see if time is after your change.</dd>
  <dt>Check for server's CA </dt>
  <dd>If you've installed a Certificate Authority(CA) into java, you
can check the CA by running this command.
    <pre>        cd `sipx-config --jdk`<br />        bin/keytool -list -keystore jre/lib/security/cacerts -storepass changeit | grep mykey<br />      </pre>
  </dd>
  <dt>Start server from console</dt>
  <dd>You can run Profile Generator by itself after RMI Registry is
started by running
    <pre>   su - SIPXPBXUSER profilegenerator.sh<br />   </pre>
    where SIPXPBXUSER is the daemon sipX user account (default is 'sipx')
  </dd>
  <dt>Resetting superadmin password</dt>
  <dd>Run this command from the console, superadmin password will be
blank until you reset it from the web ui.
    <pre>		psql -U postgres PDS -c "update users set password='' where display_id = 'superadmin';"<br />	</pre>
  </dd>
</dl>
<h2>Profile Publisher</h2>
<dl>
  <dt>Analyze the logs</dt>
  <dd><code>sds.log</code>
for SIP and SIP stack level messages to phone devices. This log
contains SIP messages so you can use the sipviewer to display
graphically the SIP messages.
    <pre>      syslog2siptrace &lt; sds.log &gt; sds-siptrace.xml<br />      sipviewer sds-siptrace.xml<br />    </pre>
  </dd>
  <dd><code>PDSMessages.log</code> for communication of
user, permission and credential datasets to other sipX servers.</dd>
  <dt>Change log level</dt>
  <dd>edit file: <code>bin/profilepublisher.sh</code> and change the
debug flag: <code>PDS_DEBUG=-Dpds.debug=true</code> and restart
processses. </dd>
  <dt>Start server from console</dt>
  <dd>You can run Profile Publisher by itself after RMI Registry is
started by running
    <pre>   su - SIPXPBXUSER profilepublisher.sh<br />   </pre>
    where SIPXPBXUSER is the daemon sipX user account (default is 'sipx')
  </dd>
</dl>
<h2>Profile Writer</h2>
<dl>
  <dt>Analyze the log</dt>
  <dd><code>profilewriter.log</code></dd>
  <dt>Change log level</dt>
  <dd>edit file: <code>bin/profilewriter.sh</code> and change the
debug flag: <code>PDS_DEBUG=-Dpds.debug=true</code> and restart
processses </dd>
  <dt>Start server from console</dt>
  <dd>You can run Profile Publisher by itself after RMI Registry is
started by running:
    <pre>   su - SIPXPBXUSER profilewriter.sh<br />   </pre>
    where SIPXPBXUSER is the daemon sipX user account (default is 'sipx')
  </dd>
</dl>
<h2>RMI registry</h2>
<dl>
  <dt>Start server from console</dt>
  <dd>RMI registry does not have a console, but you analyze what's
getting written to stdout or stderr by running rmi from the console:
    <pre>      su - SIPXPBXUSER startrmireg.sh<br />  </pre>
    where SIPXPBXUSER is the daemon sipX user account (default is 'sipx').
Personally, I've never seen an error here, but it's worth noting. </dd>
</dl>
</body>
</html>
