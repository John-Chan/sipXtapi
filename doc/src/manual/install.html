<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

 <head>
  <title>sipXconfig Installation</title>
  <link rel="stylesheet" type="text/css" href="manual.css"/>

</head>
<body id="installation">

<pre class="hide">
<!-- lynx ignores CSS and shows this -->
This file was generated using the following command.  If you are
already looking at this from web browser, then please ignore this
message.

  lynx -dump doc/src/manual/install.html > INSTALL

----------------------------------------------------------
</pre>

<h1>Installation</h1>

<ol>
  <li><a href="#rh">For Redhat Users</a>
     <ol>
      <li><a href="#rh-system">System Installation</a></li>
      <li><a href="#rh-dep">Installing dependencies with up2date</a></li>
      <li><a href="#rh-jdk">Installing Java RPM</a></li>
      <li><a href="#rh-sipx">Installing RPMs from SIPfoundry</a></li>
      </ol>
   </li>

  <li><a href="#src">Installing From Source and Non-Redhat Users</a>
       <ol>
	 <li><a href="#src-dep">Dependencies</a></li>
	 <li><a href="#src-env">Environment Variables</a></li>
	 <li><a href="#src-compile">Compile and Installation</a></li>    
	 <li><a href="#src-jboss">JBOSS Setup</a></li>
	 <li><a href="#src-db">Postgres Database Setup</a></li>
	</ol>
    </li>

    <li><a href="#security">Security</a></li>
    <li><a href="#run">Running</a>
      <ol>
         <li><a href="#run-sipx">Running with other sipX servers</a></li>
         <li><a href="#run-alone">Running Standalone</a></li>
      </ol>
  </li>
      
  <li><a href="#windows">Windows</a></li>
      
</ol>

<h2><a name="rh">For Redhat Users</a></h2>

<p>These instructions apply to Enterprise and Fedora systems unless
explicitly noted</p>

<h3><a name="rh-system">System Installation</a></h3>
<ol>
  <li>Install Redhat from CDs.  You can select any set of packages
  including the minimum set of packages labled "router configuration"
  in the redhat installer process</li>

  <li>When prompted for firewall support, select "no firewall support" or
  open up the following ports in your iptables: 80, 8080, 8090, 8091,
  5060 and 5090</li>
      
</ol>

<h3><a name="rh-dep">Installing dependencies with up2date</a></h3>

<p>Fedora users may experience periodic connection errors using using
<code>up2date</code> but usually if you're persistent you can get thru
executing <code>up2date</code> repeatedly. If you do not use
<code>up2date</code>, I recommend installing postgres and apache while
installing your system, or use the redhat package manager to install
those RPMs for you.</p>

<ul>
  
  <li>Run <code>up2date</code> for the first time and follow
instructions to setup propery <code>up2date</code> operation.</li>

  <li>Run <code>up2date -u</code> to make your system is up to date.</li>

  <li>Run <code>up2date</code> on the following packages:

<dl>
   <dt>Postgres</dt>

   <dd><code>up2date rh-postgresql-server</code> <strong>*Enterprise
Users Only</strong></dd>
       
   <dd><code>up2date postgresql-server</code> <strong>*Fedora Users
Only</strong></dd>

   <dt>Apache 2 webserver</dt>
   <dd><code>up2date httpd</code></dd>

</dl>
      </li>
</ul>


<h3><a name="rh-jdk">Installing Java RPM</a></h3>

<ul>
  <li>j2sdk 1.4 or greater available by opening your webbrowser to this URL:<br/>
    <a href="http://java.sun.com/j2se/1.4.2/download.html">http://java.sun.com/j2se/1.4.2/download.html</a>
  </li>
</ul>

<h3><a name="rh-sipx">Installing RPMs from SIPfoundry</a></h3>

<p>Sipfoundry will make the following rpms available. After
downloading, you can install these by typing the command <code>rpm -iv
<em>packagename</em>.rpm</code>. It's often helpful to list more than
one rpm at a time to fullfil rpm interpackage dependencies. RPMs
listed here are in proper order to install individually.</p>


<p>Available from sipfoundry.org</p>
<ul>
  <li>sipx-jboss-2.4.10-1.noarch.rpm</li>
  <li>sipxportlib</li>
  <li>sipxtacklib</li>
  <li>sipxcommserverlib</li>
  <li>sipxconfig</li>
  <li>sipxproxy</li>
  <li>sipxregistry</li>
  <li>sipxpublisher</li>
  <li>sipxvxml</li>
  <li>sipxpbx</li>
</ul>


<h2><a name="src">Installing From Source and Non-Redhat Users</a></h2>

<p>Install the following software packages. Follow the installation
instructions for your OS.  If there is any special installation
instructions, they will be noted.</p>

<h3><a name="src-dep">Dependencies</a></h3>

<dl>

  <dt>sipXportLib (same version sipXconfig)</dt>
  <dd><a href="http://www.sipfoundry.org/sipXportLib">http://www.sipfoundry.org/sipXportLib</a></dd>

  <dt>sipXtackLib (same version sipXconfig)</dt>
  <dd><a href="http://www.sipfoundry.org/sipXtack">http://www.sipfoundry.org/sipXtack</a></dd>

  <dt>sipXcommserverLib (same version sipXconfig)</dt>
  <dd><a href="http://www.sipfoundry.org/sipXcommserverLib">http://www.sipfoundry.org/sipXcommserverLib</a></dd>

  <dt>sipXpbx (same version sipXconfig)</dt>
  <dd><a href="http://www.sipfoundry.org/sipXpbx">http://www.sipfoundry.org/sipXpbx</a></dd>

  <dt>Java SDK 1.4 (tested w/1.4.2.03)</dt>
  <dd><a href="http://java.sun.com">http://java.sun.com</a></dd>

  <dt>postgres 7.3 (tested with 7.3.4)</dt>
  <dd><a href="http://www.postgresql.org/">http://www.postgresql.org/</a></dd>

  <dt>JBoss 2.4.4 with Tomcat 4.0.1 (exactly this version!)</dt>
  <dd><a href="http://prdownloads.sourceforge.net/jboss/JBoss-2.4.4_Tomcat-4.0.1.zip">http://prdownloads.sourceforge.net/jboss/JBoss-2.4.4_Tomcat-4.0.1.zip</a></dd>

  <dt>Ant 1.6 (tested with 1.6.1)</dt>
  <dd><a href="http://ant.apache.org/">http://ant.apache.org/</a></dd>
      
</dl>

<h3><a name="src-env">Environment Variables</a></h3>

<p>Set the following environment variables:</p>

<dl>
  <dt>JAVA_HOME</dt>

  <dd>to where you installed java. This setting is just used to
compile.  After installation the <code>sipx-config --jdk</code> is used
      to find java dynamically.  That means you can upgrade your java
and not break your installation
      
  <pre>
       Example: 
           export JAVA_HOME=/usr/java/j2sdk1.4.2_03
   </pre>
  </dd>

  <dt>ANT_HOME</dt>
  <dd>where you unzipped (e.g. installed) ant
  <pre>
       Example: 
            export ANT_HOME=~/apache-ant-1.6.2
   </pre>
   </dd>

 <dt>JBOSS_HOME</dt>
 <dd>where you unzipped JBoss
 <pre>
       Example: 
          export JBOSS_HOME=~/JBoss-2.4.10_Tomcat-4.0.6
  </pre>
  </dd>
</dl>

<h3><a name="src-compile">Compiling and Installation</a></h3>

<p>If you've obtained your source from subversion, and not from a tar
file, run this command:
<pre>
  autoreconf -if
</pre>
</p>

<p>Now compile and install sipXconfig by running this command:
<pre>
     ./configure
     make
     make install
</pre>
</p>

<h3><a name="src-jboss">JBOSS Setup</a></h3>

<p>After unzipping JBoss</p>

<ol>
  <li>run this patch on it
<pre>
      patch -d ${JBOSS_HOME} -p1 &lt; sipx-jboss-configure.patch
</pre>
  </li>

  <li>be sure user running sipxpbx (most cases sipxchange) has full r/w
     access to all files and directories in <code>${JBOSS_HOME}</code></li>
</ol>

<h3><a name="src-db">Postgresql Database Setup</a></h3>

<p>Postgres needs to always be running on your system. If you've
installed sipXconfig from RPM, you shouldn't have to do this.</p>

<p>To start postgres on Redhat 9 or Fedora systems run this command.
  <pre>
      service postgresql start 
  </pre>
</p>

<p>To start postgres on Enterprise 3 systems run this command.
  <pre>
      service rhdb start 
  </pre>
</p>

<p>It's recommended you should have postgres start automatically when your machine
restarts (usually in runlevels 3 and 5).</p>

<p>Fedora and Redhat 9 usersshould run this command:

<pre>
      chkconfig postgresql on
</pre>
</p>

<p>Redhat Enterprise 3 users should run this command:

<pre>
      chkconfig rhdb on
</pre>
</p>

<p>Edit postgres config files to work. This will open up TCP connections and
allow localhost to connect to posgres</p>

<pre>
     /usr/local/sipx/bin/sipxdbmgr --setup
     /usr/local/sipx/bin/sipxdbmgr --create PDS
     /usr/local/sipx/bin/sipxdbmgr --create SDS
</pre>

<h2><a name="security">Security</a></h2>

<p>Set up an SSL key using the instructions in
sipXcommserverLib/doc/INSTALL.ssl or
/usr/share/doc/sipxcommserverlib-<em>version</em>/INSTALL.ssl.</p>


<h2><a name="run">Running</a></h2>

<h3><a name="run-sipx">Running with other sipX servers</a></h3>

<p>This is the normal configuration.  It's where all the sipx servers
like the proxy, status server, mediaserver, etc. are running on the
same machine. In this case you will want to follow the instructions in
the sipXpbx project for starting the <code>sipxpbx</code> service.
This will control the starting and stopping of the necessary
components of the configuration system.  The sipXproxy will direct SIP
messages to the Profile Publisher automatically.  If you are using
another SIP proxy other than the sipXproxy, or running the sipXproxy on
another machine, follow next section "Running Standalone".</p>


<h3><a name="run-alone">Running Standalone</a></h3>

<p>This is when you are running just the sipXconfig server on one machine.</p>

<dl>
  <dt>Directing SIP message directly to sipXconfig's Profile Publisher.</dt>
   <dd>To direct SIP messages to the ProfilePublisher, a job normally done by
the sipXproxy, edit
file: <code>/etc/sipxpbx/config.defs</code> and set following setting
to read the following values:
<pre>
    CONFIG_SERVER_SIP_PORT=5060
</pre>
  </dd>

  <dt>Starting stopping sipXconfig</dt>
  <dd>To start all the components of sipXconfig, launch the following
service as root user:

<pre>
  service httpd start
  sipxconfig start
</pre>

<p>Conversely to stop:</p>

<pre>
  sipxconfig stop
  service httpd stop
</pre>

      </dd>
</dl>


<h2><a name="windows">Windows</a></h2>

<p>Currently there is no support for windows but here is a list of
steps towards supporting Windows. Please submit your findings and
patches back to mailing list</p>


<ol>
  <li>edit <code>config.properties.in</code> and replace all variables
with <code>@VAR@</code> symbol with where you have dependencies installed</li>

  <li>Run <code>ant</code> then <code>ant install</code> on all the
<code>build.xml</code> files in these directories and in this order:
      
      <ol>
	<li>common</li>
	<li>profilegenerator</li>
	<li>profilewriter</li>
	<li>profilepublisher</li>
      </ol>
  </li>      

  <li>Compiling the Profile Publisher's SIP agent w/ MSVC 6

<p>First, see the INSTALL instructions in sipXportLib on adding glib and 
pcre to the MSVC 6 environment.  Next, you must add Java's JNI include 
and library paths to your MSVC 6 environment following the same process.</p>

<p>Assuming that you installed the SDK in <code>C:\Program
Files\Java\j2sdk1.4.2_03</code> you will need to add the
following:</p>

<dl>
  <dt>Additional Includes:</dt>
   <dd>C:\Program Files\Java\j2sdk1.4.2_03\include</dd>
   <dd>C:\Program Files\Java\j2sdk1.4.2_03\include\win32</dd>

  <dt>Additional Libs:</dt>
  <dd>C:\Program Files\Java\j2sdk1.4.2_03\lib</dd>
</dl>

  </li>

  <li>Write a series of batch scripts that mimic what these scripts do or use Cygwin
      to start your system:
      <ol>
	 <li>startrmiregistry.sh</li>
	 <li>profilewriter.sh</li>
	 <li>profilegenerator.sh</li>
	 <li>profilepublisher.sh</li>
      </ol>
  </li>
      
</ol>  

<span id="lastmodified">
<!-- hhmts start -->
Last modified: Thu Oct 21 15:39:00 EDT 2004
<!-- hhmts end -->
</span>

</body>
</html>
